{"version":3,"file":"config.min.js","sources":["../../src/extension-detector/config.js"],"sourcesContent":["/**\n * @fileoverview Configuration pour la d√©tection d'extensions\n * @module quizaccess_cheatdetect/extension-detector/config\n * @copyright 2025 CBlue SRL <support@cblue.be>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since 1.0.0\n */\n\ndefine([], function() {\n    'use strict';\n\n    /**\n     * @typedef {Object} ExtensionConfig\n     * @property {string} name - Nom affich√© de l'extension\n     * @property {Object.<string, string>} extensionIds - IDs d'extension par navigateur\n     * @property {string[]} textKeywords - Mots-cl√©s √† rechercher dans le contenu texte\n     * @property {Object.<string, string[]>} files - Fichiers d'extension √† v√©rifier\n     * @property {PatternConfig} patterns - Motifs d'attributs HTML\n     */\n\n    /**\n     * @typedef {Object} PatternConfig\n     * @property {string[]} ids - Motifs d'ID d'√©l√©ment\n     * @property {string[]} classes - Motifs de classe CSS\n     */\n\n    /**\n     * @typedef {Object} SettingsConfig\n     * @property {number} shadowDOMCheckDelay - D√©lai de v√©rification du Shadow DOM (ms)\n     * @property {number} fileCheckTimeout - Timeout pour la v√©rification des fichiers (ms)\n     * @property {boolean} removeDetectedElements - Supprimer les √©l√©ments d√©tect√©s\n     * @property {boolean} enableLogging - Activer les logs de d√©bogage\n     */\n\n    /**\n     * Configurations de d√©tection d'extensions\n     * @type {Object.<string, ExtensionConfig>}\n     * @readonly\n     */\n    var EXTENSIONS = {\n        crowdly: {\n            key: 'crowdly',\n            name: 'Crowdly ‚Äì AI Study Assistant for Moodle',\n\n            // IDs d'extension d√©tect√©s dynamiquement (sera rempli au runtime lors de la d√©tection)\n            detectedIds: [],\n\n            // Mots-cl√©s √† rechercher dans le contenu texte\n            textKeywords: ['crowdly.sh/', 'AI Magic'],\n\n            // Motifs d'attributs HTML\n            patterns: {\n                // Motifs d'ID d'√©l√©ment\n                ids: ['crowd'],\n\n                // Motifs de classe CSS\n                classes: ['crowd']\n            }\n        }\n    };\n\n    /**\n     * Param√®tres de d√©tection\n     * @type {SettingsConfig}\n     * @readonly\n     */\n    var SETTINGS = {\n        shadowDOMCheckDelay: 1000,\n        fileCheckTimeout: 5000,\n        removeDetectedElements: true,\n        enableLogging: true\n    };\n\n    /**\n     * Expression r√©guli√®re pour d√©tecter les URLs d'extension multi-navigateur\n     * @type {RegExp}\n     * @readonly\n     */\n    var EXTENSION_URL_REGEX = /(chrome-extension:\\/\\/|moz-extension:\\/\\/)([a-z0-9-]+)/;\n\n    /**\n     * Obtient la configuration d'extension par cl√©\n     * @function getExtension\n     * @param {string} key - Cl√© de l'extension\n     * @returns {ExtensionConfig|null} Configuration de l'extension ou null si non trouv√©e\n     * @example\n     * const crowdlyConfig = getExtension('crowdly');\n     * console.log(crowdlyConfig.name); // \"Crowdly ‚Äì AI Study Assistant for Moodle\"\n     * @since 1.0.0\n     */\n    var getExtension = function(key) {\n        return EXTENSIONS[key] || null;\n    };\n\n    /**\n     * Obtient toutes les extensions configur√©es\n     * @function getAllExtensions\n     * @returns {Array.<ExtensionConfig & {key: string}>} Tableau de toutes les extensions avec leur cl√©\n     * @example\n     * const allExtensions = getAllExtensions();\n     * allExtensions.forEach(ext => console.log(ext.key, ext.name));\n     * @since 1.0.0\n     */\n    var getAllExtensions = function() {\n        return Object.keys(EXTENSIONS).map(function(key) {\n            return Object.assign({key: key}, EXTENSIONS[key]);\n        });\n    };\n\n    /**\n     * Obtient tous les IDs d'extension d√©tect√©s dynamiquement\n     * @function getExtensionId\n     * @param {string} extensionKey - Cl√© de l'extension\n     * @returns {string[]|null} Tableau des IDs d√©tect√©s ou null\n     * @example\n     * const ids = getExtensionId('crowdly');\n     * // [\"abc123\", \"xyz789\"]\n     * @since 1.0.0\n     * @deprecated Utiliser getAllExtensionIds √† la place\n     */\n    var getExtensionId = function(extensionKey) {\n        return getAllExtensionIds(extensionKey);\n    };\n\n    /**\n     * Obtient tous les IDs d'extension d√©tect√©s dynamiquement\n     * @function getAllExtensionIds\n     * @param {string} extensionKey - Cl√© de l'extension\n     * @returns {string[]} Tableau de tous les IDs d'extension d√©tect√©s\n     * @example\n     * const ids = getAllExtensionIds('crowdly');\n     * // [\"abc123xyz\", \"def456ghi\"]\n     * @since 1.0.0\n     */\n    var getAllExtensionIds = function(extensionKey) {\n        var extension = getExtension(extensionKey);\n        if (!extension) {\n            return [];\n        }\n\n        // Retourner uniquement les IDs d√©tect√©s dynamiquement\n        return extension.detectedIds || [];\n    };\n\n    /**\n     * Ajoute un ID d'extension d√©tect√© dynamiquement\n     * @function addDetectedExtensionId\n     * @param {string} extensionKey - Cl√© de l'extension\n     * @param {string} extensionId - ID d'extension √† ajouter\n     * @returns {boolean} True si l'ID a √©t√© ajout√© avec succ√®s\n     * @example\n     * addDetectedExtensionId('crowdly', 'abc123xyz');\n     * @since 1.0.0\n     */\n    var addDetectedExtensionId = function(extensionKey, extensionId) {\n        var extension = getExtension(extensionKey);\n        if (!extension) {\n            return false;\n        }\n\n        if (!extension.detectedIds) {\n            extension.detectedIds = [];\n        }\n\n        // √âviter les doublons\n        if (extension.detectedIds.indexOf(extensionId) === -1) {\n            extension.detectedIds.push(extensionId);\n            if (SETTINGS.enableLogging) {\n                // eslint-disable-next-line no-console\n                console.log('üß© Extension Detector: ID d\\'extension ajout√© pour ' +\n                    extensionKey + ' : ' + extensionId);\n            }\n            return true;\n        }\n\n        return false;\n    };\n\n    /**\n     * V√©rifie si un ID d'extension appartient √† une extension configur√©e\n     * @function matchesExtensionId\n     * @param {string} extensionKey - Cl√© de l'extension\n     * @param {string} extensionId - ID d'extension √† v√©rifier\n     * @returns {boolean} True si l'ID correspond √† l'extension\n     * @example\n     * matchesExtensionId('crowdly', 'abc123xyz');\n     * @since 1.0.0\n     */\n    var matchesExtensionId = function(extensionKey, extensionId) {\n        var allIds = getAllExtensionIds(extensionKey);\n        return allIds.indexOf(extensionId) !== -1;\n    };\n\n    // API publique\n    return {\n        EXTENSIONS: EXTENSIONS,\n        SETTINGS: SETTINGS,\n        EXTENSION_URL_REGEX: EXTENSION_URL_REGEX,\n        getExtension: getExtension,\n        getAllExtensions: getAllExtensions,\n        getExtensionId: getExtensionId,\n        getAllExtensionIds: getAllExtensionIds,\n        addDetectedExtensionId: addDetectedExtensionId,\n        matchesExtensionId: matchesExtensionId\n    };\n});"],"names":["define","EXTENSIONS","crowdly","key","name","detectedIds","textKeywords","patterns","ids","classes","SETTINGS","shadowDOMCheckDelay","fileCheckTimeout","removeDetectedElements","enableLogging","getExtension","getAllExtensionIds","extensionKey","extension","EXTENSION_URL_REGEX","getAllExtensions","Object","keys","map","assign","getExtensionId","addDetectedExtensionId","extensionId","indexOf","push","console","log","matchesExtensionId"],"mappings":";;;;;;;AAQAA,0DAAO,IAAI,eA+BHC,WAAa,CACbC,QAAS,CACLC,IAAK,UACLC,KAAM,0CAGNC,YAAa,GAGbC,aAAc,CAAC,cAAe,YAG9BC,SAAU,CAENC,IAAK,CAAC,SAGNC,QAAS,CAAC,YAUlBC,SAAW,CACXC,oBAAqB,IACrBC,iBAAkB,IAClBC,wBAAwB,EACxBC,eAAe,GAoBfC,aAAe,SAASZ,YACjBF,WAAWE,MAAQ,MA2C1Ba,mBAAqB,SAASC,kBAC1BC,UAAYH,aAAaE,qBACxBC,WAKEA,UAAUb,aAJN,UAyDR,CACHJ,WAAYA,WACZS,SAAUA,SACVS,oBAvHsB,yDAwHtBJ,aAAcA,aACdK,iBAhGmB,kBACZC,OAAOC,KAAKrB,YAAYsB,KAAI,SAASpB,YACjCkB,OAAOG,OAAO,CAACrB,IAAKA,KAAMF,WAAWE,UA+FhDsB,eAhFiB,SAASR,qBACnBD,mBAAmBC,eAgF1BD,mBAAoBA,mBACpBU,uBAhDyB,SAAST,aAAcU,iBAC5CT,UAAYH,aAAaE,sBACxBC,YAIAA,UAAUb,cACXa,UAAUb,YAAc,KAIwB,IAAhDa,UAAUb,YAAYuB,QAAQD,eAC9BT,UAAUb,YAAYwB,KAAKF,aACvBjB,SAASI,eAETgB,QAAQC,IAAI,qDACRd,aAAe,MAAQU,cAExB,KA+BXK,mBAfqB,SAASf,aAAcU,oBAEJ,IAD3BX,mBAAmBC,cAClBW,QAAQD"}