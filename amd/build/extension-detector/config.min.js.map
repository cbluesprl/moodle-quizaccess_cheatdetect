{"version":3,"file":"config.min.js","sources":["../../src/extension-detector/config.js"],"sourcesContent":["/**\n * @fileoverview Configuration for extension detection\n * @module quizaccess_cheatdetect/extension-detector/config\n * @copyright 2025 CBlue SRL <support@cblue.be>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since 1.0.0\n */\n\ndefine([], function() {\n    'use strict';\n\n    /**\n     * @typedef {Object} ExtensionConfig\n     * @property {string} name - Display name of the extension\n     * @property {Object.<string, string>} extensionIds - Extension IDs per browser\n     * @property {string[]} textKeywords - Keywords to search in text content\n     * @property {Object.<string, string[]>} files - Extension files to check\n     * @property {PatternConfig} patterns - HTML attribute patterns\n     */\n\n    /**\n     * @typedef {Object} PatternConfig\n     * @property {string[]} ids - Element ID patterns\n     * @property {string[]} classes - CSS class patterns\n     */\n\n    /**\n     * @typedef {Object} SettingsConfig\n     * @property {number} shadowDOMCheckDelay - Shadow DOM check delay (ms)\n     * @property {number} fileCheckTimeout - File check timeout (ms)\n     * @property {boolean} removeDetectedElements - Remove detected elements\n     * @property {boolean} enableLogging - Enable debug logging\n     */\n\n    /**\n     * Extension detection configurations\n     * @type {Object.<string, ExtensionConfig>}\n     * @readonly\n     */\n    var EXTENSIONS = {\n        crowdly: {\n            key: 'crowdly',\n            name: 'Crowdly â€“ AI Study Assistant for Moodle',\n\n            // Dynamically detected extension IDs (filled at runtime during detection)\n            detectedIds: [],\n\n            // Keywords to search in text content\n            textKeywords: ['crowdly.sh/', 'AI Magic'],\n\n            // HTML attribute patterns\n            patterns: {\n                // Element ID patterns\n                ids: ['crowd'],\n\n                // CSS class patterns\n                classes: ['crowd']\n            }\n        }\n    };\n\n    /**\n     * Detection settings\n     * @type {SettingsConfig}\n     * @readonly\n     */\n    var SETTINGS = {\n        shadowDOMCheckDelay: 1000,\n        fileCheckTimeout: 5000,\n        removeDetectedElements: true,\n        enableLogging: true\n    };\n\n    /**\n     * Regular expression to detect multi-browser extension URLs\n     * @type {RegExp}\n     * @readonly\n     */\n    var EXTENSION_URL_REGEX = /(chrome-extension:\\/\\/|moz-extension:\\/\\/)([a-z0-9-]+)/;\n\n    /**\n     * Get extension configuration by key\n     * @function getExtension\n     * @param {string} key - Extension key\n     * @returns {ExtensionConfig|null} Extension configuration or null if not found\n     * @example\n     * const crowdlyConfig = getExtension('crowdly');\n     * console.log(crowdlyConfig.name); // \"Crowdly â€“ AI Study Assistant for Moodle\"\n     * @since 1.0.0\n     */\n    var getExtension = function(key) {\n        return EXTENSIONS[key] || null;\n    };\n\n    /**\n     * Get all configured extensions\n     * @function getAllExtensions\n     * @returns {Array.<ExtensionConfig & {key: string}>} Array of all extensions with their key\n     * @example\n     * const allExtensions = getAllExtensions();\n     * allExtensions.forEach(ext => console.log(ext.key, ext.name));\n     * @since 1.0.0\n     */\n    var getAllExtensions = function() {\n        return Object.keys(EXTENSIONS).map(function(key) {\n            return Object.assign({key: key}, EXTENSIONS[key]);\n        });\n    };\n\n    /**\n     * Get all dynamically detected extension IDs\n     * @function getAllExtensionIds\n     * @param {string} extensionKey - Extension key\n     * @returns {string[]} Array of all detected extension IDs\n     * @example\n     * const ids = getAllExtensionIds('crowdly');\n     * // [\"abc123xyz\", \"def456ghi\"]\n     * @since 1.0.0\n     */\n    var getAllExtensionIds = function(extensionKey) {\n        var extension = getExtension(extensionKey);\n        if (!extension) {\n            return [];\n        }\n\n        // Return only dynamically detected IDs\n        return extension.detectedIds || [];\n    };\n\n    /**\n     * Add a dynamically detected extension ID\n     * @function addDetectedExtensionId\n     * @param {string} extensionKey - Extension key\n     * @param {string} extensionId - Extension ID to add\n     * @returns {boolean} True if ID was added successfully\n     * @example\n     * addDetectedExtensionId('crowdly', 'abc123xyz');\n     * @since 1.0.0\n     */\n    var addDetectedExtensionId = function(extensionKey, extensionId) {\n        var extension = getExtension(extensionKey);\n        if (!extension) {\n            return false;\n        }\n\n        if (!extension.detectedIds) {\n            extension.detectedIds = [];\n        }\n\n        // Avoid duplicates\n        if (extension.detectedIds.indexOf(extensionId) === -1) {\n            extension.detectedIds.push(extensionId);\n            if (SETTINGS.enableLogging) {\n                // eslint-disable-next-line no-console\n                console.log('ðŸ§© Extension Detector: Extension ID added for ' +\n                    extensionKey + ': ' + extensionId);\n            }\n            return true;\n        }\n\n        return false;\n    };\n\n    /**\n     * Check if an extension ID belongs to a configured extension\n     * @function matchesExtensionId\n     * @param {string} extensionKey - Extension key\n     * @param {string} extensionId - Extension ID to check\n     * @returns {boolean} True if ID matches the extension\n     * @example\n     * matchesExtensionId('crowdly', 'abc123xyz');\n     * @since 1.0.0\n     */\n    var matchesExtensionId = function(extensionKey, extensionId) {\n        var allIds = getAllExtensionIds(extensionKey);\n        return allIds.indexOf(extensionId) !== -1;\n    };\n\n    // Public API\n    return {\n        EXTENSIONS: EXTENSIONS,\n        SETTINGS: SETTINGS,\n        EXTENSION_URL_REGEX: EXTENSION_URL_REGEX,\n        getExtension: getExtension,\n        getAllExtensions: getAllExtensions,\n        getAllExtensionIds: getAllExtensionIds,\n        addDetectedExtensionId: addDetectedExtensionId,\n        matchesExtensionId: matchesExtensionId\n    };\n});\n"],"names":["define","EXTENSIONS","crowdly","key","name","detectedIds","textKeywords","patterns","ids","classes","SETTINGS","shadowDOMCheckDelay","fileCheckTimeout","removeDetectedElements","enableLogging","getExtension","getAllExtensionIds","extensionKey","extension","EXTENSION_URL_REGEX","getAllExtensions","Object","keys","map","assign","addDetectedExtensionId","extensionId","indexOf","push","console","log","matchesExtensionId"],"mappings":";;;;;;;AAQAA,0DAAO,IAAI,eA+BHC,WAAa,CACbC,QAAS,CACLC,IAAK,UACLC,KAAM,0CAGNC,YAAa,GAGbC,aAAc,CAAC,cAAe,YAG9BC,SAAU,CAENC,IAAK,CAAC,SAGNC,QAAS,CAAC,YAUlBC,SAAW,CACXC,oBAAqB,IACrBC,iBAAkB,IAClBC,wBAAwB,EACxBC,eAAe,GAoBfC,aAAe,SAASZ,YACjBF,WAAWE,MAAQ,MA4B1Ba,mBAAqB,SAASC,kBAC1BC,UAAYH,aAAaE,qBACxBC,WAKEA,UAAUb,aAJN,UAyDR,CACHJ,WAAYA,WACZS,SAAUA,SACVS,oBAxGsB,yDAyGtBJ,aAAcA,aACdK,iBAjFmB,kBACZC,OAAOC,KAAKrB,YAAYsB,KAAI,SAASpB,YACjCkB,OAAOG,OAAO,CAACrB,IAAKA,KAAMF,WAAWE,UAgFhDa,mBAAoBA,mBACpBS,uBA/CyB,SAASR,aAAcS,iBAC5CR,UAAYH,aAAaE,sBACxBC,YAIAA,UAAUb,cACXa,UAAUb,YAAc,KAIwB,IAAhDa,UAAUb,YAAYsB,QAAQD,eAC9BR,UAAUb,YAAYuB,KAAKF,aACvBhB,SAASI,eAETe,QAAQC,IAAI,iDACRb,aAAe,KAAOS,cAEvB,KA8BXK,mBAdqB,SAASd,aAAcS,oBAEJ,IAD3BV,mBAAmBC,cAClBU,QAAQD"}