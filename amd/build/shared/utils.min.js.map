{"version":3,"file":"utils.min.js","sources":["../../src/shared/utils.js"],"sourcesContent":["/**\n * @fileoverview Shared utilities between extension-detector and tracking modules\n * @module quizaccess_cheatdetect/shared/utils\n * @copyright 2025 CBlue SRL <support@cblue.be>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since 1.0.0\n */\n\ndefine([], function() {\n    'use strict';\n\n    /**\n     * Generate a reliable timestamp with timezone information\n     * @function generateTimestamp\n     * @returns {Object} Object containing Unix timestamp and timezone\n     * @property {number} unix - Unix timestamp in milliseconds\n     * @property {string} timezone - User's local timezone\n     * @example\n     * const timestamp = generateTimestamp();\n     * // { unix: 1640995200000, timezone: \"Europe/Paris\" }\n     * @since 1.0.0\n     */\n    var generateTimestamp = function() {\n        return {\n            unix: Date.now(),\n            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone\n        };\n    };\n\n    /**\n     * Fetch with custom timeout\n     * @function fetchWithTimeout\n     * @param {string} url - URL to fetch\n     * @param {number} [timeout=5000] - Timeout in milliseconds\n     * @returns {Promise<Object>} Promise resolving with fetch result\n     * @property {boolean} success - Indicates if request succeeded\n     * @property {number} [status] - HTTP status code if successful\n     * @property {Response} [response] - Response object if successful\n     * @property {string} [error] - Error message if failed\n     * @example\n     * fetchWithTimeout('https://example.com/api', 3000)\n     *   .then(result => {\n     *     if (result.success) {\n     *       return result.response.json();\n     *     }\n     *   });\n     * @since 1.0.0\n     */\n    var fetchWithTimeout = function(url, timeout) {\n        timeout = timeout || 5000;\n\n        return new Promise(function(resolve) {\n            var controller = new AbortController();\n            var timeoutId = setTimeout(function() {\n                controller.abort();\n            }, timeout);\n\n            fetch(url, { signal: controller.signal })\n                .then(function(response) {\n                    clearTimeout(timeoutId);\n                    resolve({\n                        success: response.ok,\n                        status: response.status,\n                        response: response.ok ? response : null\n                    });\n                })\n                .catch(function(error) {\n                    clearTimeout(timeoutId);\n                    resolve({\n                        success: false,\n                        error: error.name === 'AbortError' ? 'Timeout' : error.message\n                    });\n                });\n        });\n    };\n\n    return {\n        generateTimestamp: generateTimestamp,\n        fetchWithTimeout: fetchWithTimeout\n    };\n});\n"],"names":["define","generateTimestamp","unix","Date","now","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","fetchWithTimeout","url","timeout","Promise","resolve","controller","AbortController","timeoutId","setTimeout","abort","fetch","signal","then","response","clearTimeout","success","ok","status","catch","error","name","message"],"mappings":";;;;;;;AAQAA,OAAM,sCAAC,GAAI,WAoEP,MAAO,CACHC,kBAvDoB,WACpB,MAAO,CACHC,KAAMC,KAAKC,MACXC,SAAUC,KAAKC,iBAAiBC,kBAAkBC,WAqDtDC,iBA9BmB,SAASC,IAAKC,SAGjC,OAFAA,QAAUA,SAAW,IAEd,IAAIC,QAAQ,SAASC,SACxB,IAAIC,WAAa,IAAIC,gBACjBC,UAAYC,WAAW,WACvBH,WAAWI,OACd,EAAEP,SAEHQ,MAAMT,IAAK,CAAEU,OAAQN,WAAWM,SAC3BC,KAAK,SAASC,UACXC,aAAaP,WACbH,QAAQ,CACJW,QAASF,SAASG,GAClBC,OAAQJ,SAASI,OACjBJ,SAAUA,SAASG,GAAKH,SAAW,MAE3C,GACCK,MAAM,SAASC,OACZL,aAAaP,WACbH,QAAQ,CACJW,SAAS,EACTI,MAAsB,eAAfA,MAAMC,KAAwB,UAAYD,MAAME,SAE/D,EACR,IAOR"}