/**
 * @fileoverview Gestionnaire de modales d'avertissement sécurisé
 * @module quizaccess_cheatdetect/shared/modal
 * @copyright 2025 CBlue SRL <support@cblue.be>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since 1.0.0
 */
define("quizaccess_cheatdetect/shared/modal",["quizaccess_cheatdetect/shared/utils","quizaccess_cheatdetect/extension-detector/config"],function(Utils,Config){var currentModalId=null,currentExtensionKey=null,eventLogger=null,handleModalButtonClick=function(){eventLogger?eventLogger({action:"extension_modal_dismissed",data:{extensionKey:currentExtensionKey,modalAction:Config.SETTINGS.reloadOnModalClose?"reload":"close"}}):console.error("❌ eventLogger non configuré pour extension_modal_dismissed !"),!0===Config.SETTINGS.reloadOnModalClose?window.location.reload():closeModal()},closeModal=function(){if(!currentModalId)return!1;var modal=document.getElementById(currentModalId);return modal&&modal.parentNode?(modal.parentNode.removeChild(modal),currentModalId=null,currentExtensionKey=null,!0):(currentModalId=null,currentExtensionKey=null,!1)};return{showModal:function(extension,config){config=config||{};var modalId=Utils.generateUniqueId(),contentClass=Utils.generateUniqueId(),iconClass=Utils.generateUniqueId(),titleClass=Utils.generateUniqueId(),messageClass=Utils.generateUniqueId(),buttonClass=Utils.generateUniqueId(),buttonId=Utils.generateUniqueId(),animationClass=Utils.generateUniqueId(),modalConfig={icon:config.icon||"⚠️",title:config.title||"Avertissement d'intégrité académique.",message:config.message||"<p>L'extension <b>&laquo; %extension.name% &raquo;</b> a été détectée sur votre navigateur. Cette extension est incompatible avec les normes d'intégrité académique de notre plateforme. Veuillez la désactiver ou la désinstaller de votre navigateur pour continuer.</p>",buttonText:config.buttonText||"OK — J'ai retiré l'extension et je continue",theme:config.theme||{primaryColor:'var(--primary, "#d73502")',backgroundColor:"#ffffff",borderRadius:"12px",zIndex:1e4}};currentModalId=modalId,currentExtensionKey=extension.key,eventLogger?eventLogger({action:"extension_modal_shown",data:{extensionKey:extension.key}}):console.error("❌ eventLogger non configuré pour extension_modal_shown !");var modal=document.createElement("div");modal.id=modalId,modal.innerHTML="\n            <style>\n                html, body {\n                    overflow: hidden;\n                    height: 100dvh;\n                }\n                #".concat(modalId," {\n                    position: fixed;\n                    inset: 0;\n                    background: rgba(0, 0, 0, 0.6);\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    z-index: ").concat(modalConfig.theme.zIndex,";\n                }\n\n                #").concat(modalId," .").concat(contentClass," {\n                    background: ").concat(modalConfig.theme.backgroundColor,";\n                    border-radius: ").concat(modalConfig.theme.borderRadius,";\n                    padding: 32px;\n                    max-width: 700px;\n                    width: 90%;\n                    max-height: 90vh;\n                    overflow-y: auto;\n                    text-align: center;\n                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n                    animation: ").concat(animationClass," 0.3s ease-out;\n                }\n\n                @keyframes ").concat(animationClass," {\n                    from { \n                        opacity: 0; \n                        transform: scale(0.9) translateY(-20px); \n                    }\n                    to { \n                        opacity: 1; \n                        transform: scale(1) translateY(0); \n                    }\n                }\n\n                #").concat(modalId," .").concat(iconClass," { \n                    font-size: 48px; \n                    margin-bottom: 16px; \n                }\n\n                #").concat(modalId," .").concat(titleClass," { \n                    color: #333; \n                    font-size: 24px; \n                    font-weight: 600; \n                    margin: 0 0 20px 0; \n                    line-height: 1.4;\n                }\n\n                #").concat(modalId," .").concat(messageClass," { \n                    color: #333; \n                    font-size: 16px; \n                    line-height: 1.6; \n                    margin-bottom: 16px; \n                }\n\n                #").concat(modalId," .").concat(buttonClass,' { \n                    padding: 14px 28px; \n                }\n            </style>\n\n            <div class="').concat(contentClass,'">\n                <div class="').concat(iconClass,'">').concat(modalConfig.icon,'</div>\n                <div class="').concat(titleClass,'">').concat(modalConfig.title,'</div>\n                <div class="').concat(messageClass,'">').concat(modalConfig.message.replace("%extension.name%",extension.name),'</div>\n                <button class="').concat(buttonClass,' btn btn-primary" id="').concat(buttonId,'">\n                    ').concat(modalConfig.buttonText,"\n                </button>\n            </div>\n        "),document.body.appendChild(modal);var button=modal.querySelector("#"+buttonId);button?button.addEventListener("click",handleModalButtonClick):console.error("❌ Bouton de modale non trouvé !"),setTimeout(function(){button&&button.focus()},100)},isOurModalId:function(elementId){return currentModalId&&elementId===currentModalId},closeModal:closeModal,getCurrentModalId:function(){return currentModalId},setEventLogger:function(loggerFunction){eventLogger=loggerFunction}}});

//# sourceMappingURL=modal.min.js.map